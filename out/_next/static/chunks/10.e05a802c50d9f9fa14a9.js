(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[10],{"1/3A":function(t,e){t.exports=function(t){return new Promise((function(e,n){navigator.mediaDevices.getDisplayMedia(t).then(t=>{const n=document.createElement("video");n.srcObject=t,n.addEventListener("loadedmetadata",()=>{n.play(),e({video:n})})}).catch(t=>n(t))}))}},"1NRB":function(t,e,n){const r=n("kMAL").generateGlsl,o=(n("kMAL").formatArguments,n("92KP"));var i=function(t){return this.transforms=[],this.transforms.push(t),this.defaultOutput=t.defaultOutput,this.synth=t.synth,this.defaultUniforms=t.defaultUniforms,this};i.prototype.addTransform=function(t){this.transforms.push(t)},i.prototype.out=function(t){var e=t||this.defaultOutput,n=this.glsl(e);if(this.synth.currentFunctions=[],e)try{e.render(n)}catch(error){console.log("shader could not compile",error)}},i.prototype.glsl=function(){var t=[],e=[];return this.transforms.forEach(t=>{"renderpass"===t.transform.type?console.warn("no support for renderpass"):e.push(t)}),e.length>0&&t.push(this.compile(e)),t},i.prototype.compile=function(t){var e=r(t),n={};return e.uniforms.forEach(t=>{n[t.name]=t.value}),{frag:`\n  precision mediump float;\n  ${Object.values(e.uniforms).map(t=>{let e=t.type;switch(t.type){case"texture":e="sampler2D"}return`\n      uniform ${e} ${t.name};`}).join("")}\n  uniform float time;\n  uniform vec2 resolution;\n  varying vec2 uv;\n  uniform sampler2D prevBuffer;\n\n  ${Object.values(o).map(t=>`\n            ${t.glsl}\n          `).join("")}\n\n  ${e.glslFunctions.map(t=>`\n            ${t.transform.glsl}\n          `).join("")}\n\n  void main () {\n    vec4 c = vec4(1, 0, 0, 1);\n    vec2 st = gl_FragCoord.xy/resolution.xy;\n    gl_FragColor = ${e.fragColor};\n  }\n  `,uniforms:Object.assign({},this.defaultUniforms,n)}},t.exports=i},"4Zri":function(t,e,n){var r=n("QmfQ");t.exports={init:()=>{Array.prototype.fast=function(t=1){return this._speed=t,this},Array.prototype.smooth=function(t=1){return this._smooth=t,this},Array.prototype.ease=function(t="linear"){return"function"==typeof t?(this._smooth=1,this._ease=t):r[t]&&(this._smooth=1,this._ease=r[t]),this},Array.prototype.offset=function(t=.5){return this._offset=t%1,this},Array.prototype.fit=function(t=0,e=1){let n=Math.min(...this),r=Math.max(...this);var o=this.map(o=>((t,e,n,r,o)=>(t-e)*(o-r)/(n-e)+r)(o,n,r,t,e));return o._speed=this._speed,o._smooth=this._smooth,o._ease=this._ease,o}},getValue:(t=[])=>({time:e,bpm:n})=>{let o=t._speed?t._speed:1,i=t._smooth?t._smooth:0,s=e*o*(n/60)+(t._offset||0);if(0!==i){let e=t._ease?t._ease:r.linear,n=s-i/2,o=t[Math.floor(n%t.length)],a=t[Math.floor((n+1)%t.length)];return e(Math.min(n%1/i,1))*(a-o)+o}return t[Math.floor(s%t.length)]}}},"4pX0":function(t,e,n){var r;window,r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/index.js")}({"./node_modules/assert/assert.js":function(t,e,n){"use strict";(function(e){function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"===typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var i=n("./node_modules/webpack-stream/node_modules/util/util.js"),s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,c="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function l(t){return!o(t)&&"function"===typeof e.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var f=t.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function m(t){if(i.isFunction(t)){if(c)return t.name;var e=t.toString().match(p);return e&&e[1]}}function h(t,e){return"string"===typeof t?t.length<e?t:t.slice(0,e):t}function d(t){if(c||!i.isFunction(t))return i.inspect(t);var e=m(t);return"[Function"+(e?": "+e:"")+"]"}function y(t,e,n,r,o){throw new f.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:o})}function v(t,e){t||y(t,!0,e,"==",f.ok)}function g(t,e,n,s){if(t===e)return!0;if(o(t)&&o(e))return 0===r(t,e);if(i.isDate(t)&&i.isDate(e))return t.getTime()===e.getTime();if(i.isRegExp(t)&&i.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"===typeof t||null!==e&&"object"===typeof e){if(l(t)&&l(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var c=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),function(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(i.isPrimitive(t)||i.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=b(t),s=b(e);if(o&&!s||!o&&s)return!1;if(o)return g(t=a.call(t),e=a.call(e),n);var c,u,l=_(t),f=_(e);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),u=l.length-1;u>=0;u--)if(l[u]!==f[u])return!1;for(u=l.length-1;u>=0;u--)if(!g(t[c=l[u]],e[c],n,r))return!1;return!0}(t,e,n,s))}return n?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(n){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var o;if("function"!==typeof e)throw new TypeError('"block" argument must be a function');"string"===typeof n&&(r=n,n=null),o=function(t){var e;try{t()}catch(n){e=n}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!o&&y(o,n,"Missing expected exception"+r);var s="string"===typeof r,a=!t&&o&&!n;if((!t&&i.isError(o)&&s&&x(o,n)||a)&&y(o,n,"Got unwanted exception"+r),t&&o&&n&&!x(o,n)||!t&&o)throw o}f.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=h(d((e=this).actual),128)+" "+e.operator+" "+h(d(e.expected),128),this.generatedMessage=!0);var n=t.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var r=new Error;if(r.stack){var o=r.stack,i=m(n),s=o.indexOf("\n"+i);if(s>=0){var a=o.indexOf("\n",s+1);o=o.substring(a+1)}this.stack=o}}},i.inherits(f.AssertionError,Error),f.fail=y,f.ok=v,f.equal=function(t,e,n){t!=e&&y(t,e,n,"==",f.equal)},f.notEqual=function(t,e,n){t==e&&y(t,e,n,"!=",f.notEqual)},f.deepEqual=function(t,e,n){g(t,e,!1)||y(t,e,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,n){g(t,e,!0)||y(t,e,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,n){g(t,e,!1)&&y(t,e,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,n,r){g(e,n,!0)&&y(e,n,r,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,n){t!==e&&y(t,e,n,"===",f.strictEqual)},f.notStrictEqual=function(t,e,n){t===e&&y(t,e,n,"!==",f.notStrictEqual)},f.throws=function(t,e,n){w(!0,t,e,n)},f.doesNotThrow=function(t,e,n){w(!1,t,e,n)},f.ifError=function(t){if(t)throw t};var _=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n("./node_modules/webpack-stream/node_modules/webpack/buildin/global.js"))},"./node_modules/dct/index.js":function(t,e,n){t.exports=n("./node_modules/dct/src/dct.js")},"./node_modules/dct/src/dct.js":function(t,e){var n=null;t.exports=function(t,e){var r=t.length;return e=e||2,n&&n[r]||function(t){(n=n||{})[t]=new Array(t*t);for(var e=Math.PI/t,r=0;r<t;r++)for(var o=0;o<t;o++)n[t][o+r*t]=Math.cos(e*(o+.5)*r)}(r),t.map((function(){return 0})).map((function(o,i){return e*t.reduce((function(t,e,o,s){return t+e*n[r][o+i*r]}),0)}))}},"./node_modules/fftjs/dist/fft.js":function(t,e,n){"use strict";var r=n("./node_modules/fftjs/dist/utils.js"),o=function(t){var e={};void 0===t.real||void 0===t.imag?e=r.constructComplexArray(t):(e.real=t.real.slice(),e.imag=t.imag.slice());var n=e.real.length,o=Math.log2(n);if(Math.round(o)!=o)throw new Error("Input size must be a power of 2.");if(e.real.length!=e.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var i=r.bitReverseArray(n),s={real:[],imag:[]},a=0;a<n;a++)s.real[i[a]]=e.real[a],s.imag[i[a]]=e.imag[a];for(var c=0;c<n;c++)e.real[c]=s.real[c],e.imag[c]=s.imag[c];for(var u=1;u<=o;u++)for(var l=Math.pow(2,u),f=0;f<l/2;f++)for(var p=r.euler(f,l),m=0;m<n/l;m++){var h=l*m+f,d=l*m+f+l/2,y={real:e.real[h],imag:e.imag[h]},v={real:e.real[d],imag:e.imag[d]},g=r.multiply(p,v),b=r.subtract(y,g);e.real[d]=b.real,e.imag[d]=b.imag;var x=r.add(g,y);e.real[h]=x.real,e.imag[h]=x.imag}return e};t.exports={fft:o,ifft:function(t){if(void 0===t.real||void 0===t.imag)throw new Error("IFFT only accepts a complex input.");for(var e=t.real.length,n={real:[],imag:[]},i=0;i<e;i++){var s={real:t.real[i],imag:t.imag[i]},a=r.conj(s);n.real[i]=a.real,n.imag[i]=a.imag}var c=o(n);return n.real=c.real.map((function(t){return t/e})),n.imag=c.imag.map((function(t){return t/e})),n}}},"./node_modules/fftjs/dist/utils.js":function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o={},i={};t.exports={bitReverseArray:function(t){if(void 0===o[t]){for(var e=(t-1).toString(2).length,n="0".repeat(e),i={},s=0;s<t;s++){var a=s.toString(2);a=n.substr(a.length)+a,a=[].concat(r(a)).reverse().join(""),i[s]=parseInt(a,2)}o[t]=i}return o[t]},multiply:function(t,e){return{real:t.real*e.real-t.imag*e.imag,imag:t.real*e.imag+t.imag*e.real}},add:function(t,e){return{real:t.real+e.real,imag:t.imag+e.imag}},subtract:function(t,e){return{real:t.real-e.real,imag:t.imag-e.imag}},euler:function(t,e){var n=-2*Math.PI*t/e;return{real:Math.cos(n),imag:Math.sin(n)}},conj:function(t){return t.imag*=-1,t},constructComplexArray:function(t){var e={};e.real=void 0===t.real?t.slice():t.real.slice();var n=e.real.length;return void 0===i[n]&&(i[n]=Array.apply(null,Array(n)).map(Number.prototype.valueOf,0)),e.imag=i[n].slice(),e}}},"./node_modules/inherits/inherits_browser.js":function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},"./node_modules/process/browser.js":function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,u=[],l=!1,f=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&m())}function m(){if(!l){var t=a(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||l||a(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js":function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},"./node_modules/webpack-stream/node_modules/util/util.js":function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}})),c=r[n];n<i;c=r[++n])d(c)||!x(c)?s+=" "+c:s+=" "+a(c);return s},e.deprecate=function(n,r){if("undefined"!==typeof t&&!0===t.noDeprecation)return n;if("undefined"===typeof t)return function(){return e.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function a(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&e._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,t,r.depth)}function c(t,e){var n=a.styles[e];return n?"\x1b["+a.colors[n][0]+"m"+t+"\x1b["+a.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return v(o)||(o=l(t,o,r)),o}var i=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):h(e)?t.stylize(""+e,"boolean"):d(e)?t.stylize("null","null"):void 0}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),_(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(S(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(_(n))return f(n)}var u,x="",j=!1,E=["{","}"];return m(n)&&(j=!0,E=["[","]"]),S(n)&&(x=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(x=" "+RegExp.prototype.toString.call(n)),w(n)&&(x=" "+Date.prototype.toUTCString.call(n)),_(n)&&(x=" "+f(n)),0!==s.length||j&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=j?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)M(e,String(s))?i.push(p(t,e,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(p(t,e,n,r,o,!0))})),i}(t,n,r,a,s):s.map((function(e){return p(t,n,r,a,e,j)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(u,x,E)):E[0]+x+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),M(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(c.value)<0?(a=d(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),g(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function m(t){return Array.isArray(t)}function h(t){return"boolean"===typeof t}function d(t){return null===t}function y(t){return"number"===typeof t}function v(t){return"string"===typeof t}function g(t){return void 0===t}function b(t){return x(t)&&"[object RegExp]"===j(t)}function x(t){return"object"===typeof t&&null!==t}function w(t){return x(t)&&"[object Date]"===j(t)}function _(t){return x(t)&&("[object Error]"===j(t)||t instanceof Error)}function S(t){return"function"===typeof t}function j(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(g(i)&&(i=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=h,e.isNull=d,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=v,e.isSymbol=function(t){return"symbol"===typeof t},e.isUndefined=g,e.isRegExp=b,e.isObject=x,e.isDate=w,e.isError=_,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t},e.isBuffer=n("./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",O(),e.format.apply(e,arguments))},e.inherits=n("./node_modules/inherits/inherits_browser.js"),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var k="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function C(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');if(k&&t[k]){var e;if("function"!==typeof(e=t[k]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,o)}catch(s){n(s)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),k&&Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=k,e.callbackify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!==typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,n).then((function(e){t.nextTick(s,null,e)}),(function(e){t.nextTick(C,e,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/webpack-stream/node_modules/webpack/buildin/global.js":function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},"./src/extractors/chroma.js":function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate chroma");if("object"!==o(t.chromaFilterBank))throw new TypeError("Valid chromaFilterBank is required to generate chroma");var e=t.chromaFilterBank.map((function(e,n){return t.ampSpectrum.reduce((function(t,n,r){return t+n*e[r]}),0)})),n=Math.max.apply(Math,r(e));return n?e.map((function(t){return t/n})):e}},"./src/extractors/energy.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),n("./node_modules/assert/assert.js"),e.default=function(){if("object"!==r(arguments[0].signal))throw new TypeError;for(var t=0,e=0;e<arguments[0].signal.length;e++)t+=Math.pow(Math.abs(arguments[0].signal[e]),2);return t}},"./src/extractors/extractorUtilities.js":function(t,e,n){"use strict";function r(t,e){for(var n=0,r=0,o=0;o<e.length;o++)n+=Math.pow(o,t)*Math.abs(e[o]),r+=e[o];return n/r}n.r(e),n.d(e,"mu",(function(){return r}))},"./src/extractors/loudness.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(t){if("object"!==r(t.ampSpectrum)||"object"!==r(t.barkScale))throw new TypeError;var e=new Float32Array(24),n=0,o=t.ampSpectrum,i=new Int32Array(25);i[0]=0;for(var s=t.barkScale[o.length-1]/24,a=1,c=0;c<o.length;c++)for(;t.barkScale[c]>s;)i[a++]=c,s=a*t.barkScale[o.length-1]/24;i[24]=o.length-1;for(var u=0;u<24;u++){for(var l=0,f=i[u];f<i[u+1];f++)l+=o[f];e[u]=Math.pow(l,.23)}for(var p=0;p<e.length;p++)n+=e[p];return{specific:e,total:n}}},"./src/extractors/mfcc.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/powerSpectrum.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n("./src/utilities.js");var i=n("./node_modules/dct/index.js");e.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate MFCC");if("object"!==o(t.melFilterBank))throw new TypeError("Valid melFilterBank is required to generate MFCC");var e=Math.min(40,Math.max(1,t.numberOfMFCCCoefficients||13)),n=Object(r.default)(t),s=t.melFilterBank.length,a=Array(s);if(s<e)throw new Error("Insufficient filter bank for requested number of coefficients");for(var c=new Float32Array(s),u=0;u<c.length;u++){a[u]=new Float32Array(t.bufferSize/2),c[u]=0;for(var l=0;l<t.bufferSize/2;l++)a[u][l]=t.melFilterBank[u][l]*n[l],c[u]+=a[u][l];c[u]=Math.log(c[u]+1)}var f=Array.prototype.slice.call(c);return i(f).slice(0,e)}},"./src/extractors/perceptualSharpness.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/loudness.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(r.default)(arguments[0]),e=t.specific,n=0,i=0;i<e.length;i++)n+=i<15?(i+1)*e[i+1]:.066*Math.exp(.171*(i+1));return n*=.11/t.total}},"./src/extractors/perceptualSpread.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/loudness.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(r.default)(arguments[0]),e=0,n=0;n<t.specific.length;n++)t.specific[n]>e&&(e=t.specific[n]);var i=Math.pow((t.total-e)/t.total,2);return i}},"./src/extractors/powerSpectrum.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(){if("object"!==r(arguments[0].ampSpectrum))throw new TypeError;for(var t=new Float32Array(arguments[0].ampSpectrum.length),e=0;e<t.length;e++)t[e]=Math.pow(arguments[0].ampSpectrum[e],2);return t}},"./src/extractors/rms.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(t){if("object"!==r(t.signal))throw new TypeError;for(var e=0,n=0;n<t.signal.length;n++)e+=Math.pow(t.signal[n],2);return e/=t.signal.length,e=Math.sqrt(e)}},"./src/extractors/spectralCentroid.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/extractorUtilities.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;return Object(r.mu)(1,arguments[0].ampSpectrum)}},"./src/extractors/spectralFlatness.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(){if("object"!==r(arguments[0].ampSpectrum))throw new TypeError;for(var t=0,e=0,n=0;n<arguments[0].ampSpectrum.length;n++)t+=Math.log(arguments[0].ampSpectrum[n]),e+=arguments[0].ampSpectrum[n];return Math.exp(t/arguments[0].ampSpectrum.length)*arguments[0].ampSpectrum.length/e}},"./src/extractors/spectralFlux.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(t){if("object"!==r(t.signal)||"object"!=r(t.previousSignal))throw new TypeError;for(var e=0,n=-t.bufferSize/2;n<signal.length/2-1;n++)x=Math.abs(t.signal[n])-Math.abs(t.previousSignal[n]),e+=(x+Math.abs(x))/2;return e}},"./src/extractors/spectralKurtosis.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/extractorUtilities.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;var t=arguments[0].ampSpectrum,e=Object(r.mu)(1,t),n=Object(r.mu)(2,t),i=Object(r.mu)(3,t),s=Object(r.mu)(4,t),a=-3*Math.pow(e,4)+6*e*n-4*e*i+s,c=Math.pow(Math.sqrt(n-Math.pow(e,2)),4);return a/c}},"./src/extractors/spectralRolloff.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(){if("object"!==r(arguments[0].ampSpectrum))throw new TypeError;for(var t=arguments[0].ampSpectrum,e=arguments[0].sampleRate/(2*(t.length-1)),n=0,o=0;o<t.length;o++)n+=t[o];for(var i=.99*n,s=t.length-1;n>i&&s>=0;)n-=t[s],--s;return(s+1)*e}},"./src/extractors/spectralSkewness.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/extractorUtilities.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;var e=Object(r.mu)(1,t.ampSpectrum),n=Object(r.mu)(2,t.ampSpectrum),i=Object(r.mu)(3,t.ampSpectrum);return(2*Math.pow(e,3)-3*e*n+i)/Math.pow(Math.sqrt(n-Math.pow(e,2)),3)}},"./src/extractors/spectralSlope.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(t){if("object"!==r(t.ampSpectrum))throw new TypeError;for(var e=0,n=0,o=new Float32Array(t.ampSpectrum.length),i=0,s=0,a=0;a<t.ampSpectrum.length;a++){e+=t.ampSpectrum[a];var c=a*t.sampleRate/t.bufferSize;o[a]=c,i+=c*c,n+=c,s+=c*t.ampSpectrum[a]}return(t.ampSpectrum.length*s-n*e)/(e*(i-Math.pow(n,2)))}},"./src/extractors/spectralSpread.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/extractors/extractorUtilities.js");function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;return Math.sqrt(Object(r.mu)(2,t.ampSpectrum)-Math.pow(Object(r.mu)(1,t.ampSpectrum),2))}},"./src/extractors/zcr.js":function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),e.default=function(){if("object"!==r(arguments[0].signal))throw new TypeError;for(var t=0,e=1;e<arguments[0].signal.length;e++)(arguments[0].signal[e-1]>=0&&arguments[0].signal[e]<0||arguments[0].signal[e-1]<0&&arguments[0].signal[e]>=0)&&t++;return t}},"./src/featureExtractors.js":function(t,e,n){"use strict";n.r(e),n.d(e,"buffer",(function(){return x})),n.d(e,"complexSpectrum",(function(){return w})),n.d(e,"amplitudeSpectrum",(function(){return _}));var r=n("./src/extractors/rms.js");n.d(e,"rms",(function(){return r.default}));var o=n("./src/extractors/energy.js");n.d(e,"energy",(function(){return o.default}));var i=n("./src/extractors/spectralSlope.js");n.d(e,"spectralSlope",(function(){return i.default}));var s=n("./src/extractors/spectralCentroid.js");n.d(e,"spectralCentroid",(function(){return s.default}));var a=n("./src/extractors/spectralRolloff.js");n.d(e,"spectralRolloff",(function(){return a.default}));var c=n("./src/extractors/spectralFlatness.js");n.d(e,"spectralFlatness",(function(){return c.default}));var u=n("./src/extractors/spectralSpread.js");n.d(e,"spectralSpread",(function(){return u.default}));var l=n("./src/extractors/spectralSkewness.js");n.d(e,"spectralSkewness",(function(){return l.default}));var f=n("./src/extractors/spectralKurtosis.js");n.d(e,"spectralKurtosis",(function(){return f.default}));var p=n("./src/extractors/zcr.js");n.d(e,"zcr",(function(){return p.default}));var m=n("./src/extractors/loudness.js");n.d(e,"loudness",(function(){return m.default}));var h=n("./src/extractors/perceptualSpread.js");n.d(e,"perceptualSpread",(function(){return h.default}));var d=n("./src/extractors/perceptualSharpness.js");n.d(e,"perceptualSharpness",(function(){return d.default}));var y=n("./src/extractors/mfcc.js");n.d(e,"mfcc",(function(){return y.default}));var v=n("./src/extractors/chroma.js");n.d(e,"chroma",(function(){return v.default}));var g=n("./src/extractors/powerSpectrum.js");n.d(e,"powerSpectrum",(function(){return g.default}));var b=n("./src/extractors/spectralFlux.js");n.d(e,"spectralFlux",(function(){return b.default}));var x=function(t){return t.signal},w=function(t){return t.complexSpectrum},_=function(t){return t.ampSpectrum}},"./src/index.js":function(t,e,n){t.exports=n("./src/main.js").default},"./src/main.js":function(t,e,n){"use strict";n.r(e);var r=n("./src/utilities.js"),o=n("./src/featureExtractors.js"),i=n("./node_modules/fftjs/dist/fft.js"),s=n("./src/meyda-wa.js");function a(t){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:o,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,_featuresToExtract:[],windowing:r.applyWindow,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(t){return new s.MeydaAnalyzer(t,Object.assign({},c))},extract:function(t,e,n){var o=this;if(!e)throw this._errors.invalidInput;if("object"!=a(e))throw this._errors.invalidInput;if(!t)throw this._errors.featureUndef;if(!r.isPowerOfTwo(e.length))throw this._errors.notPow2;"undefined"!=typeof this.barkScale&&this.barkScale.length==this.bufferSize||(this.barkScale=r.createBarkScale(this.bufferSize,this.sampleRate,this.bufferSize)),"undefined"!=typeof this.melFilterBank&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=r.createMelFilterBank(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),"undefined"!=typeof this.chromaFilterBank&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=r.createChromaFilterBank(this.chromaBands,this.sampleRate,this.bufferSize)),"undefined"==typeof e.buffer?this.signal=r.arrayToTyped(e):this.signal=e;var i=u(e,this.windowingFunction,this.bufferSize);if(this.signal=i.windowedSignal,this.complexSpectrum=i.complexSpectrum,this.ampSpectrum=i.ampSpectrum,n){var s=u(n,this.windowingFunction,this.bufferSize);this.previousSignal=s.windowedSignal,this.previousComplexSpectrum=s.complexSpectrum,this.previousAmpSpectrum=s.ampSpectrum}var c=function(t){return o.featureExtractors[t]({ampSpectrum:o.ampSpectrum,chromaFilterBank:o.chromaFilterBank,complexSpectrum:o.complexSpectrum,signal:o.signal,bufferSize:o.bufferSize,sampleRate:o.sampleRate,barkScale:o.barkScale,melFilterBank:o.melFilterBank,previousSignal:o.previousSignal,previousAmpSpectrum:o.previousAmpSpectrum,previousComplexSpectrum:o.previousComplexSpectrum,numberOfMFCCCoefficients:o.numberOfMFCCCoefficients})};if("object"===a(t))return t.reduce((function(t,e){return Object.assign({},t,(n={},r=e,o=c(e),r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n));var n,r,o}),{});if("string"===typeof t)return c(t);throw this._errors.invalidFeatureFmt}},u=function(t,e,n){var o={};"undefined"==typeof t.buffer?o.signal=r.arrayToTyped(t):o.signal=t,o.windowedSignal=r.applyWindow(o.signal,e),o.complexSpectrum=Object(i.fft)(o.windowedSignal),o.ampSpectrum=new Float32Array(n/2);for(var s=0;s<n/2;s++)o.ampSpectrum[s]=Math.sqrt(Math.pow(o.complexSpectrum.real[s],2)+Math.pow(o.complexSpectrum.imag[s],2));return o};e.default=c,"undefined"!==typeof window&&(window.Meyda=c)},"./src/meyda-wa.js":function(t,e,n){"use strict";n.r(e),n.d(e,"MeydaAnalyzer",(function(){return s}));var r=n("./src/utilities.js"),o=n("./src/featureExtractors.js");function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e,n){var i=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._m=n,!e.audioContext)throw this._m.errors.noAC;if(e.bufferSize&&!r.isPowerOfTwo(e.bufferSize))throw this._m._errors.notPow2;if(!e.source)throw this._m._errors.noSource;this._m.audioContext=e.audioContext,this._m.bufferSize=e.bufferSize||this._m.bufferSize||256,this._m.hopSize=e.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=e.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=e.callback,this._m.windowingFunction=e.windowingFunction||"hanning",this._m.featureExtractors=o,this._m.EXTRACTION_STARTED=e.startImmediately||!1,this._m.channel="number"===typeof e.channel?e.channel:0,this._m.inputs=e.inputs||1,this._m.outputs=e.outputs||1,this._m.numberOfMFCCCoefficients=e.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=e.featureExtractors||[],this._m.barkScale=r.createBarkScale(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=r.createMelFilterBank(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(e.source),this._m.spn.onaudioprocess=function(t){if(null!==i._m.inputData&&(i._m.previousInputData=i._m.inputData),i._m.inputData=t.inputBuffer.getChannelData(i._m.channel),i._m.previousInputData)(e=new Float32Array(i._m.previousInputData.length+i._m.inputData.length-i._m.hopSize)).set(i._m.previousInputData.slice(i._m.hopSize)),e.set(i._m.inputData,i._m.previousInputData.length-i._m.hopSize);else var e=i._m.inputData;r.frame(e,i._m.bufferSize,i._m.hopSize).forEach((function(t){i._m.frame=t;var e=i._m.extract(i._m._featuresToExtract,i._m.frame,i._m.previousFrame);"function"===typeof i._m.callback&&i._m.EXTRACTION_STARTED&&i._m.callback(e),i._m.previousFrame=i._m.frame}))}}var e,n,s;return e=t,(n=[{key:"start",value:function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0}},{key:"stop",value:function(){this._m.EXTRACTION_STARTED=!1}},{key:"setSource",value:function(t){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=t,this._m.source.connect(this._m.spn)}},{key:"setChannel",value:function(t){t<=this._m.inputs?this._m.channel=t:console.error("Channel ".concat(t," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(t," when instantiating the MeydaAnalyzer"))}},{key:"get",value:function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null}}])&&i(e.prototype,n),s&&i(e,s),t}()},"./src/utilities.js":function(t,e,n){"use strict";n.r(e),n.d(e,"isPowerOfTwo",(function(){return s})),n.d(e,"error",(function(){return a})),n.d(e,"pointwiseBufferMult",(function(){return c})),n.d(e,"applyWindow",(function(){return u})),n.d(e,"createBarkScale",(function(){return l})),n.d(e,"typedToArray",(function(){return f})),n.d(e,"arrayToTyped",(function(){return p})),n.d(e,"_normalize",(function(){return m})),n.d(e,"normalize",(function(){return h})),n.d(e,"normalizeToOne",(function(){return d})),n.d(e,"mean",(function(){return y})),n.d(e,"melToFreq",(function(){return b})),n.d(e,"freqToMel",(function(){return x})),n.d(e,"createMelFilterBank",(function(){return w})),n.d(e,"hzToOctaves",(function(){return _})),n.d(e,"normalizeByColumn",(function(){return S})),n.d(e,"createChromaFilterBank",(function(){return j})),n.d(e,"frame",(function(){return E}));var r=n("./src/windowing.js");function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i={};function s(t){for(;t%2===0&&t>1;)t/=2;return 1===t}function a(t){throw new Error("Meyda: "+t)}function c(t,e){for(var n=[],r=0;r<Math.min(t.length,e.length);r++)n[r]=t[r]*e[r];return n}function u(t,e){if("rect"!==e){if(""!==e&&e||(e="hanning"),i[e]||(i[e]={}),!i[e][t.length])try{i[e][t.length]=r[e](t.length)}catch(n){throw new Error("Invalid windowing function")}t=c(t,i[e][t.length])}return t}function l(t,e,n){for(var r=new Float32Array(t),o=0;o<r.length;o++)r[o]=o*e/n,r[o]=13*Math.atan(r[o]/1315.8)+3.5*Math.atan(Math.pow(r[o]/7518,2));return r}function f(t){return Array.prototype.slice.call(t)}function p(t){return Float32Array.from(t)}function m(t,e){return t/e}function h(t,e){return t.map((function(t){return m(t,e)}))}function d(t){var e=Math.max.apply(null,t);return t.map((function(t){return t/e}))}function y(t){return t.reduce((function(t,e){return t+e}))/t.length}function v(t){return 700*(Math.exp(t/1125)-1)}function g(t){return 1125*Math.log(1+t/700)}function b(t){return v(t)}function x(t){return g(t)}function w(t,e,n){for(var r=new Float32Array(t+2),o=new Float32Array(t+2),i=e/2,s=g(0),a=(g(i)-s)/(t+1),c=Array(t+2),u=0;u<r.length;u++)r[u]=u*a,o[u]=v(r[u]),c[u]=Math.floor((n+1)*o[u]/e);for(var l=Array(t),f=0;f<l.length;f++){l[f]=Array.apply(null,new Array(n/2+1)).map(Number.prototype.valueOf,0);for(var p=c[f];p<c[f+1];p++)l[f][p]=(p-c[f])/(c[f+1]-c[f]);for(var m=c[f+1];m<c[f+2];m++)l[f][m]=(c[f+2]-m)/(c[f+2]-c[f+1])}return l}function _(t,e){return Math.log2(16*t/e)}function S(t){var e=t[0].map((function(){return 0})),n=t.reduce((function(t,e){return e.forEach((function(e,n){t[n]+=Math.pow(e,2)})),t}),e).map(Math.sqrt);return t.map((function(t,e){return t.map((function(t,e){return t/(n[e]||1)}))}))}function j(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:440,c=Math.floor(n/2)+1,u=new Array(n).fill(0).map((function(r,o){return t*_(e*o/n,a)}));u[0]=u[1]-1.5*t;var l=u.slice(1).map((function(t,e){return Math.max(t-u[e])}),1).concat([1]),f=Math.round(t/2),p=new Array(t).fill(0).map((function(e,n){return u.map((function(e){return(10*t+f+e-n)%t-f}))})),m=p.map((function(t,e){return t.map((function(t,n){return Math.exp(-.5*Math.pow(2*p[e][n]/l[n],2))}))}));if(m=S(m),i){var h=u.map((function(e){return Math.exp(-.5*Math.pow((e/t-r)/i,2))}));m=m.map((function(t){return t.map((function(t,e){return t*h[e]}))}))}return s&&(m=[].concat(o(m.slice(3)),o(m.slice(0,3)))),m.map((function(t){return t.slice(0,c)}))}function E(t,e,n){if(t.length<e)throw new Error("Buffer is too short for frame length");if(n<1)throw new Error("Hop length cannot be less that 1");if(e<1)throw new Error("Frame length cannot be less that 1");var r=1+Math.floor((t.length-e)/n);return new Array(r).fill(0).map((function(r,o){return t.slice(o*n,o*n+e)}))}},"./src/windowing.js":function(t,e,n){"use strict";function r(t){for(var e=new Float32Array(t),n=2*Math.PI/(t-1),r=2*n,o=0;o<t/2;o++)e[o]=.42-.5*Math.cos(o*n)+.08*Math.cos(o*r);for(var i=t/2;i>0;i--)e[t-i]=e[i-1];return e}function o(t){for(var e=Math.PI/(t-1),n=new Float32Array(t),r=0;r<t;r++)n[r]=Math.sin(e*r);return n}function i(t){for(var e=new Float32Array(t),n=0;n<t;n++)e[n]=.5-.5*Math.cos(2*Math.PI*n/(t-1));return e}function s(t){for(var e=new Float32Array(t),n=0;n<t;n++)e[n]=.54-.46*Math.cos(2*Math.PI*(n/t-1));return e}n.r(e),n.d(e,"blackman",(function(){return r})),n.d(e,"sine",(function(){return o})),n.d(e,"hanning",(function(){return i})),n.d(e,"hamming",(function(){return s}))}})},t.exports=r()},"7qWv":function(module,exports){module.exports=parent=>{var initialCode="",sandbox=createSandbox(initialCode),addToContext=(t,e)=>{sandbox=createSandbox(initialCode+=`\n      var ${t} = ${e}\n    `)};return{addToContext:addToContext,eval:t=>sandbox.eval(t)};function createSandbox(initial){eval(initial);var localEval=function(code){eval(code)};return{eval:localEval}}}},"8oxB":function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,u=[],l=!1,f=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&m())}function m(){if(!l){var t=a(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||l||a(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"92KP":function(t,e){t.exports={_luminance:{type:"util",glsl:"float _luminance(vec3 rgb){\n      const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n      return dot(rgb, W);\n    }"},_noise:{type:"util",glsl:"\n    //\tSimplex 3D Noise\n    //\tby Ian McEwan, Ashima Arts\n    vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\n  vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\n\n  float _noise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //  x0 = x0 - 0. + 0.0 * C\n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n  // Permutations\n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute(\n               i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n             + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n             + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  // Gradients\n  // ( N*N points uniformly over a square, mapped onto an octahedron.)\n    float n_ = 1.0/7.0; // N=7\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n  //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n  // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                  dot(p2,x2), dot(p3,x3) ) );\n  }\n    "},_rgbToHsv:{type:"util",glsl:"vec3 _rgbToHsv(vec3 c){\n            vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n            vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n            vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n            float d = q.x - min(q.w, q.y);\n            float e = 1.0e-10;\n            return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n        }"},_hsvToRgb:{type:"util",glsl:"vec3 _hsvToRgb(vec3 c){\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }"}}},AJid:function(t,e,n){const r=n("4pX0");t.exports=class{constructor({numBins:t=4,cutoff:e=2,smooth:n=.4,max:o=15,scale:i=10,isDrawing:s=!1}){this.vol=0,this.scale=i,this.max=o,this.cutoff=e,this.smooth=n,this.setBins(t),this.beat={holdFrames:20,threshold:40,_cutoff:0,decay:.98,_framesSinceBeat:0},this.onBeat=()=>{},this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=80,this.canvas.style.width="100px",this.canvas.style.height="80px",this.canvas.style.position="absolute",this.canvas.style.right="0px",this.canvas.style.bottom="0px",document.body.appendChild(this.canvas),this.isDrawing=s,this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#DFFFFF",this.ctx.strokeStyle="#0ff",this.ctx.lineWidth=.5,window.navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(t=>{this.stream=t,this.context=new AudioContext;let e=this.context.createMediaStreamSource(t);this.meyda=r.createMeydaAnalyzer({audioContext:this.context,source:e,featureExtractors:["loudness"]})}).catch(t=>console.log("ERROR",t))}detectBeat(t){t>this.beat._cutoff&&t>this.beat.threshold?(this.onBeat(),this.beat._cutoff=1.2*t,this.beat._framesSinceBeat=0):this.beat._framesSinceBeat<=this.beat.holdFrames?this.beat._framesSinceBeat++:(this.beat._cutoff*=this.beat.decay,this.beat._cutoff=Math.max(this.beat._cutoff,this.beat.threshold))}tick(){if(this.meyda){var t=this.meyda.get();if(t&&null!==t){this.vol=t.loudness.total,this.detectBeat(this.vol);const e=(t,e)=>t+e;let n=Math.floor(t.loudness.specific.length/this.bins.length);this.prevBins=this.bins.slice(0),this.bins=this.bins.map((r,o)=>t.loudness.specific.slice(o*n,(o+1)*n).reduce(e)).map((t,e)=>t*(1-this.settings[e].smooth)+this.prevBins[e]*this.settings[e].smooth),this.fft=this.bins.map((t,e)=>Math.max(0,(t-this.settings[e].cutoff)/this.settings[e].scale)),this.isDrawing&&this.draw()}}}setCutoff(t){this.cutoff=t,this.settings=this.settings.map(e=>(e.cutoff=t,e))}setSmooth(t){this.smooth=t,this.settings=this.settings.map(e=>(e.smooth=t,e))}setBins(t){this.bins=Array(t).fill(0),this.prevBins=Array(t).fill(0),this.fft=Array(t).fill(0),this.settings=Array(t).fill(0).map(()=>({cutoff:this.cutoff,scale:this.scale,smooth:this.smooth})),this.bins.forEach((t,e)=>{window["a"+e]=(t=1,n=0)=>()=>a.fft[e]*t+n})}setScale(t){this.scale=t,this.settings=this.settings.map(e=>(e.scale=t,e))}setMax(t){this.max=t,console.log("set max is deprecated")}hide(){this.isDrawing=!1,this.canvas.style.display="none"}show(){this.isDrawing=!0,this.canvas.style.display="block"}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var t=this.canvas.width/this.bins.length,e=this.canvas.height/(2*this.max);this.bins.forEach((n,r)=>{var o=n*e;this.ctx.fillRect(r*t,this.canvas.height-o,t,o);var i=this.canvas.height-e*this.settings[r].cutoff;this.ctx.beginPath(),this.ctx.moveTo(r*t,i),this.ctx.lineTo((r+1)*t,i),this.ctx.stroke();var s=this.canvas.height-e*(this.settings[r].scale+this.settings[r].cutoff);this.ctx.beginPath(),this.ctx.moveTo(r*t,s),this.ctx.lineTo((r+1)*t,s),this.ctx.stroke()})}}},DqOa:function(t,e,n){const r=n("SpVx"),o=n("1NRB");const i={src:{returnType:"vec4",args:["vec2 _st"]},coord:{returnType:"vec2",args:["vec2 _st"]},color:{returnType:"vec4",args:["vec4 _c0"]},combine:{returnType:"vec4",args:["vec4 _c0","vec4 _c1"]},combineCoord:{returnType:"vec2",args:["vec2 _st","vec4 _c0"]}};t.exports=class{constructor({defaultUniforms:t,defaultOutput:e,extendTransforms:n=[],changeListener:r=(()=>{})}={}){this.defaultOutput=e,this.defaultUniforms=t,this.changeListener=r,this.extendTransforms=n,this.generators={},this.init()}init(){this.glslTransforms={},this.generators=Object.entries(this.generators).reduce((t,[e,n])=>(this.changeListener({type:"remove",synth:this,method:e}),t),{}),this.sourceClass=class extends o{};let t=r;return Array.isArray(this.extendTransforms)?t.concat(this.extendTransforms):"object"===typeof this.extendTransforms&&t.push(this.extendTransforms),t.map(t=>this.setFunction(t))}_addMethod(t,e){if(this.glslTransforms[t]=e,"src"===e.type){const n=(...n)=>new this.sourceClass({name:t,transform:e,userArgs:n,defaultOutput:this.defaultOutput,defaultUniforms:this.defaultUniforms,synth:this});return this.generators[t]=n,this.changeListener({type:"add",synth:this,method:t}),n}this.sourceClass.prototype[t]=function(...n){return this.transforms.push({name:t,transform:e,userArgs:n}),this}}setFunction(t){var e=function(t){let e=i[t.type];if(e){let n=e.args.map(t=>t).join(", "),r=t.inputs.map(t=>`${t.type} ${t.name}`).join(", "),o=`${n}${r.length>0?", "+r:""}`,i=`\n  ${e.returnType} ${t.name}(${o}) {\n      ${t.glsl}\n  }\n`;return"combine"!==t.type&&"combineCoord"!==t.type||t.inputs.unshift({name:"color",type:"vec4"}),Object.assign({},t,{glsl:i})}console.warn(`type ${t.type} not recognized`)}(t);e&&this._addMethod(t.name,e)}}},JqCA:function(t,e,n){const r=n("sxUk"),o=n("Zyyk"),i=n("T/oo"),s=n("kbhw")(),a=n("AJid"),c=n("rkk5"),u=n("4Zri"),l=n("c/VR"),f=n("DqOa");t.exports=class{constructor({pb:t=null,width:e=1280,height:n=720,numSources:r=4,numOutputs:i=4,makeGlobal:a=!0,autoLoop:f=!0,detectAudio:p=!0,enableStreamCapture:m=!0,canvas:h,precision:d="mediump",extendTransforms:y={}}={}){u.init(),this.pb=t,this.width=e,this.height=n,this.renderAll=!1,this.detectAudio=p,this._initCanvas(h),this.synth={time:0,bpm:30,width:this.width,height:this.height,fps:void 0,stats:{fps:0},speed:1,mouse:s,render:this._render.bind(this),setResolution:this.setResolution.bind(this),update:t=>{},hush:this.hush.bind(this)},this.timeSinceLastUpdate=0,this._time=0;let v=["lowp","mediump","highp"].includes(d.toLowerCase());this.precision=v?d.toLowerCase():"mediump",v||console.warn('[hydra-synth warning]\nConstructor was provided an invalid floating point precision value of "'+d+'". Using default value of "mediump" instead.'),this.extendTransforms=y,this.saveFrame=!1,this.captureStream=null,this.generator=void 0,this._initRegl(),this._initOutputs(i),this._initSources(r),this._generateGlslTransforms(),this.synth.screencap=()=>{this.saveFrame=!0},m&&(this.captureStream=this.canvas.captureStream(25),this.synth.vidRecorder=new c(this.captureStream)),p&&this._initAudio(),f&&o(this.tick.bind(this)).start(),this.sandbox=new l(this.synth,a,["speed","update","bpm","fps"])}eval(t){this.sandbox.eval(t)}getScreenImage(t){this.imageCallback=t,this.saveFrame=!0}hush(){this.s.forEach(t=>{t.clear()}),this.o.forEach(t=>{this.synth.solid(1,1,1,0).out(t)})}setResolution(t,e){this.canvas.width=t,this.canvas.height=e,this.width=t,this.height=e,this.o.forEach(n=>{n.resize(t,e)}),this.s.forEach(n=>{n.resize(t,e)}),console.log(this.canvas.width)}canvasToImage(t){const e=document.createElement("a");e.style.display="none";let n=new Date;e.download=`hydra-${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}-${n.getHours()}.${n.getMinutes()}.${n.getSeconds()}.png`,document.body.appendChild(e);var r=this;this.canvas.toBlob(t=>{r.imageCallback?(r.imageCallback(t),delete r.imageCallback):(e.href=URL.createObjectURL(t),console.log(e.href),e.click())},"image/png"),setTimeout(()=>{document.body.removeChild(e),window.URL.revokeObjectURL(e.href)},300)}_initAudio(){this.synth.a=new a({numBins:4})}_initCanvas(t){t?(this.canvas=t,this.width=t.width,this.height=t.height):(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.imageRendering="pixelated",document.body.appendChild(this.canvas))}_initRegl(){this.regl=n("fbvF")({canvas:this.canvas,pixelRatio:1}),this.regl.clear({color:[0,0,0,1]}),this.renderAll=this.regl({frag:`\n      precision ${this.precision} float;\n      varying vec2 uv;\n      uniform sampler2D tex0;\n      uniform sampler2D tex1;\n      uniform sampler2D tex2;\n      uniform sampler2D tex3;\n\n      void main () {\n        vec2 st = vec2(1.0 - uv.x, uv.y);\n        st*= vec2(2);\n        vec2 q = floor(st).xy*(vec2(2.0, 1.0));\n        int quad = int(q.x) + int(q.y);\n        st.x += step(1., mod(st.y,2.0));\n        st.y += step(1., mod(st.x,2.0));\n        st = fract(st);\n        if(quad==0){\n          gl_FragColor = texture2D(tex0, st);\n        } else if(quad==1){\n          gl_FragColor = texture2D(tex1, st);\n        } else if (quad==2){\n          gl_FragColor = texture2D(tex2, st);\n        } else {\n          gl_FragColor = texture2D(tex3, st);\n        }\n\n      }\n      `,vert:`\n      precision ${this.precision} float;\n      attribute vec2 position;\n      varying vec2 uv;\n\n      void main () {\n        uv = position;\n        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),tex1:this.regl.prop("tex1"),tex2:this.regl.prop("tex2"),tex3:this.regl.prop("tex3")},count:3,depth:{enable:!1}}),this.renderFbo=this.regl({frag:`\n      precision ${this.precision} float;\n      varying vec2 uv;\n      uniform vec2 resolution;\n      uniform sampler2D tex0;\n\n      void main () {\n        gl_FragColor = texture2D(tex0, vec2(1.0 - uv.x, uv.y));\n      }\n      `,vert:`\n      precision ${this.precision} float;\n      attribute vec2 position;\n      varying vec2 uv;\n\n      void main () {\n        uv = position;\n        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),resolution:this.regl.prop("resolution")},count:3,depth:{enable:!1}})}_initOutputs(t){const e=this;this.o=Array(t).fill().map((t,n)=>{var o=new r({regl:this.regl,width:this.width,height:this.height,precision:this.precision});return o.id=n,e.synth["o"+n]=o,o}),this.output=this.o[0]}_initSources(t){this.s=[];for(var e=0;e<t;e++)this.createSource()}createSource(){let t=new i({regl:this.regl,pb:this.pb,width:this.width,height:this.height});return this.synth["s"+this.s.length]=t,this.s.push(t),t}_generateGlslTransforms(){var t=this;this.generator=new f({defaultOutput:this.o[0],defaultUniforms:this.o[0].uniforms,extendTransforms:this.extendTransforms,changeListener:({type:e,method:n,synth:r})=>{"add"===e&&(t.synth[n]=r.generators[n],t.sandbox&&t.sandbox.add(n))}}),this.synth.setFunction=this.generator.setFunction.bind(this.generator)}_render(t){t?(this.output=t,this.isRenderingAll=!1):this.isRenderingAll=!0}tick(t,e){if(this.sandbox.tick(),!0===this.detectAudio&&this.synth.a.tick(),this.synth.update)try{this.synth.update(t)}catch(n){console.log(error)}if(this.sandbox.set("time",this.synth.time+=.001*t*this.synth.speed),this.timeSinceLastUpdate+=t,!this.synth.fps||this.timeSinceLastUpdate>=1e3/this.synth.fps){this.synth.stats.fps=Math.ceil(1e3/this.timeSinceLastUpdate);for(let t=0;t<this.s.length;t++)this.s[t].tick(this.synth.time);for(let t=0;t<this.o.length;t++)this.o[t].tick({time:this.synth.time,mouse:this.synth.mouse,bpm:this.synth.bpm,resolution:[this.canvas.width,this.canvas.height]});this.isRenderingAll?this.renderAll({tex0:this.o[0].getCurrent(),tex1:this.o[1].getCurrent(),tex2:this.o[2].getCurrent(),tex3:this.o[3].getCurrent(),resolution:[this.canvas.width,this.canvas.height]}):this.renderFbo({tex0:this.output.getCurrent(),resolution:[this.canvas.width,this.canvas.height]}),this.timeSinceLastUpdate=0}!0===this.saveFrame&&(this.canvasToImage(),this.saveFrame=!1)}}},Mkpu:function(t,e,n){"use strict";n.r(e);var r=n("q1tI"),o=n.n(r),i=n("UJlA"),s=o.a.createElement,a=n("Rryd"),c=Object(i.a)("canvas",{width:"100%"});e.default=function(t){t.height,t.width;return Object(r.useEffect)((function(){document.getElementById("hydra-canvas");var t=new a({canvas:document.getElementById("hydra-canvas"),detectAudio:!1});t.shape(1,1).mult(t.voronoi(1e3,2).blend(t.o0).luma()).add(t.shape(3,.225).rotate(1,1).mult(t.voronoi(1e3,1).luma()).rotate(1.5)).scrollX([.1,-.0625,.005,1e-5],0).scrollY([.1,-.0625,.005,1e-5],0).out(t.o0),t.s1.initImage("/marsa.jpg"),t.src(t.s1).out(t.o1),t.src(t.o0).contrast(.7).brightness().luma(1.3,.2).mult(t.o1).saturate().thresh(.2,.1).out(t.o2),t.render(t.o2)})),s(c,{id:"hydra-canvas",width:"1000",height:"562"})}},P7XM:function(t,e){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},QmfQ:function(t,e){t.exports={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},sin:function(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2}}},Rryd:function(t,e,n){const r=n("JqCA");t.exports=r},SpVx:function(t,e){t.exports=[{name:"noise",type:"src",inputs:[{type:"float",name:"scale",default:10},{type:"float",name:"offset",default:.1}],glsl:"   return vec4(vec3(_noise(vec3(_st*scale, offset*time))), 1.0);"},{name:"voronoi",type:"src",inputs:[{type:"float",name:"scale",default:5},{type:"float",name:"speed",default:.3},{type:"float",name:"blending",default:.3}],glsl:"   vec3 color = vec3(.0);\n   // Scale\n   _st *= scale;\n   // Tile the space\n   vec2 i_st = floor(_st);\n   vec2 f_st = fract(_st);\n   float m_dist = 10.;  // minimun distance\n   vec2 m_point;        // minimum point\n   for (int j=-1; j<=1; j++ ) {\n   for (int i=-1; i<=1; i++ ) {\n   vec2 neighbor = vec2(float(i),float(j));\n   vec2 p = i_st + neighbor;\n   vec2 point = fract(sin(vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3))))*43758.5453);\n   point = 0.5 + 0.5*sin(time*speed + 6.2831*point);\n   vec2 diff = neighbor + point - f_st;\n   float dist = length(diff);\n   if( dist < m_dist ) {\n   m_dist = dist;\n   m_point = point;\n   }\n   }\n   }\n   // Assign a color using the closest point position\n   color += dot(m_point,vec2(.3,.6));\n   color *= 1.0 - blending*m_dist;\n   return vec4(color, 1.0);"},{name:"osc",type:"src",inputs:[{type:"float",name:"frequency",default:60},{type:"float",name:"sync",default:.1},{type:"float",name:"offset",default:0}],glsl:"   vec2 st = _st;\n   float r = sin((st.x-offset/frequency+time*sync)*frequency)*0.5  + 0.5;\n   float g = sin((st.x+time*sync)*frequency)*0.5 + 0.5;\n   float b = sin((st.x+offset/frequency+time*sync)*frequency)*0.5  + 0.5;\n   return vec4(r, g, b, 1.0);"},{name:"shape",type:"src",inputs:[{type:"float",name:"sides",default:3},{type:"float",name:"radius",default:.3},{type:"float",name:"smoothing",default:.01}],glsl:"   vec2 st = _st * 2. - 1.;\n   // Angle and radius from the current pixel\n   float a = atan(st.x,st.y)+3.1416;\n   float r = (2.*3.1416)/sides;\n   float d = cos(floor(.5+a/r)*r-a)*length(st);\n   return vec4(vec3(1.0-smoothstep(radius,radius + smoothing,d)), 1.0);"},{name:"gradient",type:"src",inputs:[{type:"float",name:"speed",default:0}],glsl:"   return vec4(_st, sin(time*speed), 1.0);"},{name:"src",type:"src",inputs:[{type:"sampler2D",name:"tex",default:NaN}],glsl:"   //  vec2 uv = gl_FragCoord.xy/vec2(1280., 720.);\n   return texture2D(tex, fract(_st));"},{name:"solid",type:"src",inputs:[{type:"float",name:"r",default:0},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:1}],glsl:"   return vec4(r, g, b, a);"},{name:"rotate",type:"coord",inputs:[{type:"float",name:"angle",default:10},{type:"float",name:"speed",default:0}],glsl:"   vec2 xy = _st - vec2(0.5);\n   float ang = angle + speed *time;\n   xy = mat2(cos(angle),-sin(ang), sin(ang),cos(ang))*xy;\n   xy += 0.5;\n   return xy;"},{name:"scale",type:"coord",inputs:[{type:"float",name:"amount",default:1.5},{type:"float",name:"xMult",default:1},{type:"float",name:"yMult",default:1},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:"   vec2 xy = _st - vec2(offsetX, offsetY);\n   xy*=(1.0/vec2(amount*xMult, amount*yMult));\n   xy+=vec2(offsetX, offsetY);\n   return xy;\n   "},{name:"pixelate",type:"coord",inputs:[{type:"float",name:"pixelX",default:20},{type:"float",name:"pixelY",default:20}],glsl:"   vec2 xy = vec2(pixelX, pixelY);\n   return (floor(_st * xy) + 0.5)/xy;"},{name:"posterize",type:"color",inputs:[{type:"float",name:"bins",default:3},{type:"float",name:"gamma",default:.6}],glsl:"   vec4 c2 = pow(_c0, vec4(gamma));\n   c2 *= vec4(bins);\n   c2 = floor(c2);\n   c2/= vec4(bins);\n   c2 = pow(c2, vec4(1.0/gamma));\n   return vec4(c2.xyz, _c0.a);"},{name:"shift",type:"color",inputs:[{type:"float",name:"r",default:.5},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:0}],glsl:"   vec4 c2 = vec4(_c0);\n   c2.r = fract(c2.r + r);\n   c2.g = fract(c2.g + g);\n   c2.b = fract(c2.b + b);\n   c2.a = fract(c2.a + a);\n   return vec4(c2.rgba);"},{name:"repeat",type:"coord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:0},{type:"float",name:"offsetY",default:0}],glsl:"   vec2 st = _st * vec2(repeatX, repeatY);\n   st.x += step(1., mod(st.y,2.0)) * offsetX;\n   st.y += step(1., mod(st.x,2.0)) * offsetY;\n   return fract(st);"},{name:"modulateRepeat",type:"combineCoord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:"   vec2 st = _st * vec2(repeatX, repeatY);\n   st.x += step(1., mod(st.y,2.0)) + _c0.r * offsetX;\n   st.y += step(1., mod(st.x,2.0)) + _c0.g * offsetY;\n   return fract(st);"},{name:"repeatX",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:"   vec2 st = _st * vec2(reps, 1.0);\n   //  float f =  mod(_st.y,2.0);\n   st.y += step(1., mod(st.x,2.0))* offset;\n   return fract(st);"},{name:"modulateRepeatX",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:"   vec2 st = _st * vec2(reps, 1.0);\n   //  float f =  mod(_st.y,2.0);\n   st.y += step(1., mod(st.x,2.0)) + _c0.r * offset;\n   return fract(st);"},{name:"repeatY",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:"   vec2 st = _st * vec2(1.0, reps);\n   //  float f =  mod(_st.y,2.0);\n   st.x += step(1., mod(st.y,2.0))* offset;\n   return fract(st);"},{name:"modulateRepeatY",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:"   vec2 st = _st * vec2(reps, 1.0);\n   //  float f =  mod(_st.y,2.0);\n   st.x += step(1., mod(st.y,2.0)) + _c0.r * offset;\n   return fract(st);"},{name:"kaleid",type:"coord",inputs:[{type:"float",name:"nSides",default:4}],glsl:"   vec2 st = _st;\n   st -= 0.5;\n   float r = length(st);\n   float a = atan(st.y, st.x);\n   float pi = 2.*3.1416;\n   a = mod(a,pi/nSides);\n   a = abs(a-pi/nSides/2.);\n   return r*vec2(cos(a), sin(a));"},{name:"modulateKaleid",type:"combineCoord",inputs:[{type:"float",name:"nSides",default:4}],glsl:"   vec2 st = _st - 0.5;\n   float r = length(st);\n   float a = atan(st.y, st.x);\n   float pi = 2.*3.1416;\n   a = mod(a,pi/nSides);\n   a = abs(a-pi/nSides/2.);\n   return (_c0.r+r)*vec2(cos(a), sin(a));"},{name:"scroll",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"scrollY",default:.5},{type:"float",name:"speedX",default:0},{type:"float",name:"speedY",default:0}],glsl:"\n   _st.x += scrollX + time*speedX;\n   _st.y += scrollY + time*speedY;\n   return fract(_st);"},{name:"scrollX",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:"   _st.x += scrollX + time*speed;\n   return fract(_st);"},{name:"modulateScrollX",type:"combineCoord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:"   _st.x += _c0.r*amount + time*speed;\n   return fract(_st);"},{name:"scrollY",type:"coord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:"   _st.y += scrollY + time*speed;\n   return fract(_st);"},{name:"modulateScrollY",type:"combineCoord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:"   _st.y += _c0.r*scrollY + time*speed;\n   return fract(_st);"},{name:"add",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0+_c1)*amount + _c0*(1.0-amount);"},{name:"sub",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0-_c1)*amount + _c0*(1.0-amount);"},{name:"layer",type:"combine",inputs:[],glsl:"   return vec4(mix(_c0.rgb, _c1.rgb, _c1.a), _c0.a+_c1.a);"},{name:"blend",type:"combine",inputs:[{type:"float",name:"amount",default:.5}],glsl:"   return _c0*(1.0-amount)+_c1*amount;"},{name:"mult",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _c0*(1.0-amount)+(_c0*_c1)*amount;"},{name:"diff",type:"combine",inputs:[],glsl:"   return vec4(abs(_c0.rgb-_c1.rgb), max(_c0.a, _c1.a));"},{name:"modulate",type:"combineCoord",inputs:[{type:"float",name:"amount",default:.1}],glsl:"   //  return fract(st+(_c0.xy-0.5)*amount);\n   return _st + _c0.xy*amount;"},{name:"modulateScale",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:1}],glsl:"   vec2 xy = _st - vec2(0.5);\n   xy*=(1.0/vec2(offset + multiple*_c0.r, offset + multiple*_c0.g));\n   xy+=vec2(0.5);\n   return xy;"},{name:"modulatePixelate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:10},{type:"float",name:"offset",default:3}],glsl:"   vec2 xy = vec2(offset + _c0.x*multiple, offset + _c0.y*multiple);\n   return (floor(_st * xy) + 0.5)/xy;"},{name:"modulateRotate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:0}],glsl:"   vec2 xy = _st - vec2(0.5);\n   float angle = offset + _c0.x * multiple;\n   xy = mat2(cos(angle),-sin(angle), sin(angle),cos(angle))*xy;\n   xy += 0.5;\n   return xy;"},{name:"modulateHue",type:"combineCoord",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _st + (vec2(_c0.g - _c0.r, _c0.b - _c0.g) * amount * 1.0/resolution);"},{name:"invert",type:"color",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return vec4((1.0-_c0.rgb)*amount + _c0.rgb*(1.0-amount), _c0.a);"},{name:"contrast",type:"color",inputs:[{type:"float",name:"amount",default:1.6}],glsl:"   vec4 c = (_c0-vec4(0.5))*vec4(amount) + vec4(0.5);\n   return vec4(c.rgb, _c0.a);"},{name:"brightness",type:"color",inputs:[{type:"float",name:"amount",default:.4}],glsl:"   return vec4(_c0.rgb + vec3(amount), _c0.a);"},{name:"mask",type:"combine",inputs:[],glsl:"   float a = _luminance(_c1.rgb);\n   return vec4(_c0.rgb*a, a);"},{name:"luma",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.1}],glsl:"   float a = smoothstep(threshold-tolerance, threshold+tolerance, _luminance(_c0.rgb));\n   return vec4(_c0.rgb*a, a);"},{name:"thresh",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.04}],glsl:"   return vec4(vec3(smoothstep(threshold-tolerance, threshold+tolerance, _luminance(_c0.rgb))), _c0.a);"},{name:"color",type:"color",inputs:[{type:"float",name:"r",default:1},{type:"float",name:"g",default:1},{type:"float",name:"b",default:1},{type:"float",name:"a",default:1}],glsl:"   vec4 c = vec4(r, g, b, a);\n   vec4 pos = step(0.0, c); // detect whether negative\n   // if > 0, return r * _c0\n   // if < 0 return (1.0-r) * _c0\n   return vec4(mix((1.0-_c0)*abs(c), c*_c0, pos));"},{name:"saturate",type:"color",inputs:[{type:"float",name:"amount",default:2}],glsl:"   const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n   vec3 intensity = vec3(dot(_c0.rgb, W));\n   return vec4(mix(intensity, _c0.rgb, amount), _c0.a);"},{name:"hue",type:"color",inputs:[{type:"float",name:"hue",default:.4}],glsl:"   vec3 c = _rgbToHsv(_c0.rgb);\n   c.r += hue;\n   //  c.r = fract(c.r);\n   return vec4(_hsvToRgb(c), _c0.a);"},{name:"colorama",type:"color",inputs:[{type:"float",name:"amount",default:.005}],glsl:"   vec3 c = _rgbToHsv(_c0.rgb);\n   c += vec3(amount);\n   c = _hsvToRgb(c);\n   c = fract(c);\n   return vec4(c, _c0.a);"},{name:"prev",type:"src",inputs:[],glsl:"   return texture2D(prevBuffer, fract(_st));"},{name:"sum",type:"color",inputs:[{type:"vec4",name:"scale",default:1}],glsl:"   vec4 v = _c0 * s;\n   return v.r + v.g + v.b + v.a;\n   }\n   float sum(vec2 _st, vec4 s) { // vec4 is not a typo, because argument type is not overloaded\n   vec2 v = _st.xy * s.xy;\n   return v.x + v.y;"},{name:"r",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.r * scale + offset);"},{name:"g",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.g * scale + offset);"},{name:"b",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.b * scale + offset);"},{name:"a",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.a * scale + offset);"}]},"T/oo":function(t,e,n){const r=n("mILs"),o=n("1/3A");t.exports=class{constructor(t){this.regl=t.regl,this.src=null,this.dynamic=!0,this.width=t.width,this.height=t.height,this.tex=this.regl.texture({shape:[1,1]}),this.pb=t.pb}init(t){t.src&&(this.src=t.src,this.tex=this.regl.texture(this.src)),t.dynamic&&(this.dynamic=t.dynamic)}initCam(t){const e=this;r(t).then(t=>{e.src=t.video,e.dynamic=!0,e.tex=e.regl.texture(e.src)}).catch(t=>console.log("could not get camera",t))}initVideo(t=""){const e=document.createElement("video");e.crossOrigin="anonymous",e.autoplay=!0,e.loop=!0,e.addEventListener("canplay",()=>{this.src=e,e.play(),document.body.appendChild(e),this.tex=this.regl.texture(this.src),this.dynamic=!0}),e.src=t}initImage(t=""){const e=document.createElement("img");e.crossOrigin="anonymous",e.src=t,e.onload=()=>{this.src=e,this.dynamic=!1,this.tex=this.regl.texture(this.src)}}initStream(t){let e=this;t&&this.pb&&(this.pb.initSource(t),this.pb.on("got video",(function(n,r){n===t&&(e.src=r,e.dynamic=!0,e.tex=e.regl.texture(e.src))})))}initScreen(){const t=this;o().then((function(e){t.src=e.video,t.tex=t.regl.texture(t.src),t.dynamic=!0})).catch(t=>console.log("could not get screen",t))}resize(t,e){this.width=t,this.height=e}clear(){this.src&&this.src.srcObject&&this.src.srcObject.getTracks&&this.src.srcObject.getTracks().forEach(t=>t.stop()),this.src=null,this.tex=this.regl.texture({shape:[1,1]})}tick(t){null!==this.src&&!0===this.dynamic&&(this.src.videoWidth&&this.src.videoWidth!==this.tex.width&&(console.log(this.src.videoWidth,this.src.videoHeight,this.tex.width,this.tex.height),this.tex.resize(this.src.videoWidth,this.src.videoHeight)),this.src.width&&this.src.width!==this.tex.width&&this.tex.resize(this.src.width,this.src.height),this.tex.subimage(this.src))}getTexture(){return this.tex}}},XPkA:function(t,e,n){"use strict";function r(t){return t.target||t.srcElement||window}e.buttons=function(t){if("object"===typeof t){if("buttons"in t)return t.buttons;if("which"in t){if(2===(e=t.which))return 4;if(3===e)return 2;if(e>0)return 1<<e-1}else if("button"in t){var e;if(1===(e=t.button))return 4;if(2===e)return 2;if(e>=0)return 1<<e}}return 0},e.element=r,e.x=function(t){if("object"===typeof t){if("offsetX"in t)return t.offsetX;var e=r(t).getBoundingClientRect();return t.clientX-e.left}return 0},e.y=function(t){if("object"===typeof t){if("offsetY"in t)return t.offsetY;var e=r(t).getBoundingClientRect();return t.clientY-e.top}return 0}},Zyyk:function(t,e,n){var r=n("P7XM"),o=n("fiWp").EventEmitter,i=n("jPIa"),s=n("xEkU");function a(t){if(!(this instanceof a))return new a(t);this.running=!1,this.last=i(),this._frame=0,this._tick=this.tick.bind(this),t&&this.on("tick",t)}t.exports=a,r(a,o),a.prototype.start=function(){if(!this.running)return this.running=!0,this.last=i(),this._frame=s(this._tick),this},a.prototype.stop=function(){return this.running=!1,0!==this._frame&&s.cancel(this._frame),this._frame=0,this},a.prototype.tick=function(){this._frame=s(this._tick);var t=i(),e=t-this.last;this.emit("tick",e),this.last=t}},bQgK:function(t,e,n){(function(e){(function(){var n,r,o,i,s,a;"undefined"!==typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!==typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(n()-s)/1e6},r=e.hrtime,i=(n=function(){var t;return 1e9*(t=r())[0]+t[1]})(),a=1e9*e.uptime(),s=i-a):Date.now?(t.exports=function(){return Date.now()-o},o=Date.now()):(t.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n("8oxB"))},"c/VR":function(t,e,n){const r=n("7qWv");n("4Zri");t.exports=class{constructor(t,e,n=[]){this.makeGlobal=e,this.sandbox=r(t),this.parent=t,Object.keys(t).forEach(t=>this.add(t)),this.userProps=n}add(t){this.makeGlobal&&(window[t]=this.parent[t]),this.sandbox.addToContext(t,"parent."+t)}set(t,e){this.makeGlobal&&(window[t]=e),this.parent[t]=e}tick(){this.makeGlobal&&this.userProps.forEach(t=>{this.parent[t]=window[t]})}eval(t){this.sandbox.eval(t)}}},fiWp:function(t,e,n){"use strict";var r,o="object"===typeof Reflect?Reflect:null,i=o&&"function"===typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"===typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!==t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,r){function o(){void 0!==i&&t.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==e&&(i=function(n){t.removeListener(e,o),r(n)},t.once("error",i)),t.once(e,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var o,i,s,a;if(u(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"===typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=l(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=p.bind(r);return o.listener=n,r.wrapFn=o,o}function h(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"===typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):y(o,o.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"===typeof c)i(c,this,e);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){return u(e),this.on(t,m(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,m(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,o,i,s;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return h(this,t,!0)},a.prototype.rawListeners=function(t){return h(this,t,!1)},a.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},jPIa:function(t,e,n){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,n("yLpj"))},kMAL:function(t,e,n){const r=n("4Zri"),o={float:{vec4:{name:"sum",args:[[1,1,1,1]]},vec2:{name:"sum",args:[[1,1]]}}};function i(t,e){var n=()=>"";return t.forEach(t=>{var r=u(t,e.uniforms.length);r.forEach(t=>{t.isUniform&&e.uniforms.push(t)}),function(t,e){for(var n=0;n<e.length;n++)if(t.name==e[n].name)return!0;return!1}(t,e.glslFunctions)||e.glslFunctions.push(t);var o=n;if("src"===t.transform.type)n=n=>""+s(n,t.name,r,e);else if("coord"===t.transform.type)n=n=>""+o(""+s(n,t.name,r,e));else if("color"===t.transform.type)n=n=>""+s(""+o(n),t.name,r,e);else if("combine"===t.transform.type){var a=r[0].value&&r[0].value.transforms?t=>""+i(r[0].value.transforms,e)(t):r[0].isUniform?()=>r[0].name:()=>r[0].value;n=n=>""+s(`${o(n)}, ${a(n)}`,t.name,r.slice(1),e)}else if("combineCoord"===t.transform.type){a=r[0].value&&r[0].value.transforms?t=>""+i(r[0].value.transforms,e)(t):r[0].isUniform?()=>r[0].name:()=>r[0].value;n=n=>""+o(""+s(`${n}, ${a(n)}`,t.name,r.slice(1),e))}}),n}function s(t,e,n,r){return`${e}(${t}${n.map(t=>t.isUniform?t.name:t.value&&t.value.transforms?""+i(t.value.transforms,r)("st"):t.value).reduce((t,e)=>`${t}, ${e}`,"")})`}function a(t,e){for(;t.length<e;)3===t.length?t.push(1):t.push(0);return t.slice(0,e)}t.exports={generateGlsl:function(t){var e={uniforms:[],glslFunctions:[],fragColor:""},n=i(t,e)("st");return e.fragColor=n,e},formatArguments:u};const c=t=>((t=t.toString()).indexOf(".")<0&&(t+="."),t);function u(t,e){const n=t.transform.inputs,i=t.userArgs;return n.map((t,n)=>{const s={value:t.default,type:t.type,isUniform:!1,name:t.name,vecLen:0};if("float"===s.type&&(s.value=c(t.default)),t.type.startsWith("vec"))try{s.vecLen=Number.parseInt(t.type.substr(3))}catch(f){console.log(`Error determining length of vector input type ${t.type} (${t.name})`)}if(i.length>n&&(s.value=i[n],"function"===typeof i[n]?(s.vecLen>0?s.value=(t,e,r)=>a(i[n](e),s.vecLen):s.value=(e,r,o)=>{try{return i[n](r)}catch(f){return console.log("ERROR",f),t.default}},s.isUniform=!0):i[n].constructor===Array&&(s.vecLen>0?(s.isUniform=!0,s.value=a(s.value,s.vecLen)):(s.value=(t,e,o)=>r.getValue(i[n])(e),s.isUniform=!0))),e<0);else{if(s.value&&s.value.transforms){const e=s.value.transforms[s.value.transforms.length-1];if(e.transform.glsl_return_type!==t.type){const n=o[t.type];if("undefined"!==typeof n){const t=n[e.transform.glsl_return_type];if("undefined"!==typeof t){const{name:e,args:n}=t;s.value=s.value[e](...n)}}}s.isUniform=!1}else if("float"===s.type&&"number"===typeof s.value)s.value=c(s.value);else if(s.type.startsWith("vec")&&"object"===typeof s.value&&Array.isArray(s.value))s.isUniform=!1,s.value=`${s.type}(${s.value.map(c).join(", ")})`;else if("sampler2D"===t.type){var u=s.value;s.value=()=>u.getTexture(),s.isUniform=!0}else if(s.value.getTexture&&"vec4"===t.type){var l=s.value;s.value=src(l),s.isUniform=!1}s.isUniform&&(s.name+=e)}return s})}},kbhw:function(t,e,n){"use strict";t.exports=function(t,e){e||(e=t,t=window);var n=0,o=0,i=0,s={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function c(t){var e=!1;return"altKey"in t&&(e=e||t.altKey!==s.alt,s.alt=!!t.altKey),"shiftKey"in t&&(e=e||t.shiftKey!==s.shift,s.shift=!!t.shiftKey),"ctrlKey"in t&&(e=e||t.ctrlKey!==s.control,s.control=!!t.ctrlKey),"metaKey"in t&&(e=e||t.metaKey!==s.meta,s.meta=!!t.metaKey),e}function u(t,a){var u=r.x(a),l=r.y(a);"buttons"in a&&(t=0|a.buttons),(t!==n||u!==o||l!==i||c(a))&&(n=0|t,o=u||0,i=l||0,e&&e(n,o,i,s))}function l(t){u(0,t)}function f(){(n||o||i||s.shift||s.alt||s.meta||s.control)&&(o=i=0,n=0,s.shift=s.alt=s.control=s.meta=!1,e&&e(0,0,0,s))}function p(t){c(t)&&e&&e(n,o,i,s)}function m(t){0===r.buttons(t)?u(0,t):u(n,t)}function h(t){u(n|r.buttons(t),t)}function d(t){u(n&~r.buttons(t),t)}function y(){a||(a=!0,t.addEventListener("mousemove",m),t.addEventListener("mousedown",h),t.addEventListener("mouseup",d),t.addEventListener("mouseleave",l),t.addEventListener("mouseenter",l),t.addEventListener("mouseout",l),t.addEventListener("mouseover",l),t.addEventListener("blur",f),t.addEventListener("keyup",p),t.addEventListener("keydown",p),t.addEventListener("keypress",p),t!==window&&(window.addEventListener("blur",f),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}y();var v={element:t};return Object.defineProperties(v,{enabled:{get:function(){return a},set:function(e){e?y():function(){if(!a)return;a=!1,t.removeEventListener("mousemove",m),t.removeEventListener("mousedown",h),t.removeEventListener("mouseup",d),t.removeEventListener("mouseleave",l),t.removeEventListener("mouseenter",l),t.removeEventListener("mouseout",l),t.removeEventListener("mouseover",l),t.removeEventListener("blur",f),t.removeEventListener("keyup",p),t.removeEventListener("keydown",p),t.removeEventListener("keypress",p),t!==window&&(window.removeEventListener("blur",f),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p))}()},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return i},enumerable:!0},mods:{get:function(){return s},enumerable:!0}}),v};var r=n("XPkA")},mILs:function(t,e){t.exports=function(t){return navigator.mediaDevices.enumerateDevices().then(t=>t.filter(t=>"videoinput"===t.kind)).then(e=>{let n={audio:!1,video:!0};return e[t]&&(n.video={deviceId:{exact:e[t].deviceId}}),window.navigator.mediaDevices.getUserMedia(n)}).then(t=>{const e=document.createElement("video");return e.srcObject=t,new Promise((t,n)=>{e.addEventListener("loadedmetadata",()=>{e.play().then(()=>t({video:e}))})})}).catch(console.log.bind(console))}},rkk5:function(t,e){t.exports=class{constructor(t){this.mediaSource=new MediaSource,this.stream=t,this.output=document.createElement("video"),this.output.autoplay=!0,this.output.loop=!0;let e=this;this.mediaSource.addEventListener("sourceopen",()=>{console.log("MediaSource opened"),e.sourceBuffer=e.mediaSource.addSourceBuffer('video/webm; codecs="vp8"'),console.log("Source buffer: ",sourceBuffer)})}start(){let t={mimeType:"video/webm;codecs=vp9"};this.recordedBlobs=[];try{this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(e){console.log("Unable to create MediaRecorder with options Object: ",e);try{t={mimeType:"video/webm,codecs=vp9"},this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(n){console.log("Unable to create MediaRecorder with options Object: ",n);try{t="video/vp8",this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(r){return alert("MediaRecorder is not supported by this browser.\n\nTry Firefox 29 or later, or Chrome 47 or later, with Enable experimental Web Platform features enabled from chrome://flags."),void console.error("Exception while creating MediaRecorder:",r)}}}console.log("Created MediaRecorder",this.mediaRecorder,"with options",t),this.mediaRecorder.onstop=this._handleStop.bind(this),this.mediaRecorder.ondataavailable=this._handleDataAvailable.bind(this),this.mediaRecorder.start(100),console.log("MediaRecorder started",this.mediaRecorder)}stop(){this.mediaRecorder.stop()}_handleStop(){const t=new Blob(this.recordedBlobs,{type:this.mediaRecorder.mimeType}),e=window.URL.createObjectURL(t);this.output.src=e;const n=document.createElement("a");n.style.display="none",n.href=e;let r=new Date;n.download=`hydra-${r.getFullYear()}-${r.getMonth()+1}-${r.getDate()}-${r.getHours()}.${r.getMinutes()}.${r.getSeconds()}.webm`,document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(e)},300)}_handleDataAvailable(t){t.data&&t.data.size>0&&this.recordedBlobs.push(t.data)}}},sxUk:function(t,e){var n=function(t){this.regl=t.regl,this.precision=t.precision,this.positionBuffer=this.regl.buffer([[-2,0],[0,-2],[2,2]]),this.draw=()=>{},this.init(),this.pingPongIndex=0,this.fbos=Array(2).fill().map(()=>this.regl.framebuffer({color:this.regl.texture({mag:"nearest",width:t.width,height:t.height,format:"rgba"}),depthStencil:!1}))};n.prototype.resize=function(t,e){this.fbos.forEach(n=>{n.resize(t,e)})},n.prototype.getCurrent=function(){return this.fbos[this.pingPongIndex]},n.prototype.getTexture=function(){var t=this.pingPongIndex?0:1;return this.fbos[t]},n.prototype.init=function(){return this.transformIndex=0,this.fragHeader=`\n  precision ${this.precision} float;\n\n  uniform float time;\n  varying vec2 uv;\n  `,this.fragBody="",this.vert=`\n  precision ${this.precision} float;\n  attribute vec2 position;\n  varying vec2 uv;\n\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }`,this.attributes={position:this.positionBuffer},this.uniforms={time:this.regl.prop("time"),resolution:this.regl.prop("resolution")},this.frag=`\n       ${this.fragHeader}\n\n      void main () {\n        vec4 c = vec4(0, 0, 0, 0);\n        vec2 st = uv;\n        ${this.fragBody}\n        gl_FragColor = c;\n      }\n  `,this},n.prototype.render=function(t){let e=t[0];var n=this,r=Object.assign(e.uniforms,{prevBuffer:()=>n.fbos[n.pingPongIndex]});n.draw=n.regl({frag:e.frag,vert:n.vert,attributes:n.attributes,uniforms:r,count:3,framebuffer:()=>(n.pingPongIndex=n.pingPongIndex?0:1,n.fbos[n.pingPongIndex])})},n.prototype.tick=function(t){this.draw(t)},t.exports=n},xEkU:function(t,e,n){(function(e){for(var r=n("bQgK"),o="undefined"===typeof window?e:window,i=["moz","webkit"],s="AnimationFrame",a=o["request"+s],c=o["cancel"+s]||o["cancelRequest"+s],u=0;!a&&u<i.length;u++)a=o[i[u]+"Request"+s],c=o[i[u]+"Cancel"+s]||o[i[u]+"CancelRequest"+s];if(!a||!c){var l=0,f=0,p=[];a=function(t){if(0===p.length){var e=r(),n=Math.max(0,16.666666666666668-(e-l));l=n+e,setTimeout((function(){var t=p.slice(0);p.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(l)}catch(n){setTimeout((function(){throw n}),0)}}),Math.round(n))}return p.push({handle:++f,callback:t,cancelled:!1}),f},c=function(t){for(var e=0;e<p.length;e++)p[e].handle===t&&(p[e].cancelled=!0)}}t.exports=function(t){return a.call(o,t)},t.exports.cancel=function(){c.apply(o,arguments)},t.exports.polyfill=function(t){t||(t=o),t.requestAnimationFrame=a,t.cancelAnimationFrame=c}}).call(this,n("yLpj"))},yLpj:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n}}]);